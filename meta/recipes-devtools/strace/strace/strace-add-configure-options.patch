Add option "aio" to enable/disable libaio support.

Upstream-Status: Pending

Signed-off-by: Kai Kang <kai.kang@windriver.com>
Signed-off-by: Chong Lu <Chong.Lu@windriver.com>
---
 configure.ac |   26 ++++++++++++++++++++++++++
 1 file changed, 26 insertions(+)

diff --git a/configure.ac b/configure.ac
index e73958c..9099370 100644
--- a/configure.ac
+++ b/configure.ac
@@ -745,6 +745,20 @@ if test "x$ac_cv_lib_dl_dladdr" = xyes;
 fi
 AC_SUBST(dl_LIBS)
 
+AC_ARG_ENABLE([aio],
+	[AS_HELP_STRING([--enable-aio], [turn on libaio support])],
+	[case $enableval in
+	yes)
+	AC_CHECK_HEADERS([libaio.h], [
+		AC_CHECK_MEMBERS([struct iocb.u.c.flags],,, [#include <libaio.h>])
+		AC_CHECK_DECLS([IO_CMD_PWRITE, IO_CMD_PWRITEV],,, [#include <libaio.h>])
+	])
+	;;
+	no)  ;;
+	*)   AC_MSG_ERROR([bad value $enableval for aio option]) ;;
+	esac]
+)
+
 AC_PATH_PROG([PERL], [perl])
 
 dnl stack trace with libunwind
--
1.9.1
